<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>RPG 성소 - 관리자 로그인</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" th:href="@{/files/css/mng/mng_style.css}">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.5/js.cookie.min.js"></script>
	<script th:src="@{/files/script/mng/js/mng_commons.js}"></script>
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 font-sans h-screen flex items-center justify-center p-4">
<div class="w-full max-w-4xl bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden flex flex-col md:flex-row h-auto md:h-[600px]">
	<div class="w-full md:w-1/2 bg-indigo-50 p-12 flex flex-col justify-between relative overflow-hidden hidden md:flex">
		<div class="absolute top-0 left-0 w-full h-full pointer-events-none">
			<i class="fas fa-chess-rook text-9xl absolute -top-6 -left-6 text-indigo-100 opacity-50 transform rotate-12"></i>
		</div>
		<div class="relative z-10">
			<div class="flex items-center text-indigo-600 font-bold text-lg mb-6">
				<i class="fas fa-chess-rook mr-2"></i> RPG Admin
			</div>
			<div class="bg-white/70 backdrop-blur-sm p-6 rounded-xl border border-indigo-100/50 mb-6 shadow-sm">
				<h1 class="text-3xl font-bold leading-tight text-slate-800">
					다음 세대 용사들을<br>
					준비시키는<br>
					<span class="text-indigo-600 text-4xl mt-2 inline-block">거룩한 성소</span>
				</h1>
			</div>
			<p class="text-slate-600 text-sm leading-relaxed">
				당신의 헌신으로 우리 친구들이 믿음의 용사로 성장합니다.<br>
				오늘도 우리 친구들을 위해 기도하며 접속해주세요.
			</p>
		</div>

		<div class="relative z-10">
			<div class="flex items-center space-x-2 text-slate-500 text-xs font-medium bg-white/60 p-3 rounded-lg backdrop-blur-sm border border-indigo-100 inline-flex">
				<i class="fas fa-info-circle text-indigo-500"></i>
				<span>시스템 문의: 하나님의 사람</span>
			</div>
		</div>
	</div>

	<div class="w-full md:w-1/2 p-10 md:p-14 flex flex-col justify-center bg-white">
		<div class="mb-10">
			<h2 class="text-2xl font-bold text-slate-800">환영합니다! 👋</h2>
			<p class="text-slate-500 text-sm mt-2">관리자 계정으로 접속하여 왕국을 관리하세요.</p>
		</div>

		<div class="space-y-5">

			<div>
				<label class="block text-sm font-bold text-slate-700 mb-1.5" for="mberId">아이디</label>
				<div class="relative">
					<div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none">
						<i class="fas fa-user text-slate-400 text-sm"></i>
					</div>
					<input type="text" id="mberId" name="mberId"
					       class="w-full pl-10 pr-4 py-2.5 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all placeholder-slate-400 text-slate-800"
					       value="" placeholder="아이디 입력" required>
				</div>
			</div>

			<div>
				<div class="flex justify-between items-center mb-1.5">
					<label class="block text-sm font-bold text-slate-700" for="pwd">비밀번호</label>
				</div>
				<div class="relative">
					<div class="absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none">
						<i class="fas fa-lock text-slate-400 text-sm"></i>
					</div>
					<input type="password" id="pwd" name="pwd"
					       class="w-full pl-10 pr-10 py-2.5 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all placeholder-slate-400 text-slate-800"
					       value="" placeholder="비밀번호 입력" required>
					<button type="button" onclick="togglePassword()"
					        class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-indigo-600 cursor-pointer focus:outline-none">
						<i class="fas fa-eye text-sm" id="eyeIcon"></i>
					</button>
				</div>
			</div>

			<div class="flex items-center pt-1">
				<input id="remember-me" name="remember-me" type="checkbox"
				       class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded cursor-pointer">
				<label for="remember-me" class="ml-2 block text-sm text-slate-600 cursor-pointer select-none">
					아이디 기억
				</label>
			</div>

			<button type="submit" id="login_do"
			        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-sm hover:shadow-md transition-all active:scale-[0.98] text-sm flex justify-center items-center group mt-2">
				<span>왕국 입장하기</span>
				<i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform text-xs"></i>
			</button>
		</div>

		<div class="mt-10 text-center text-xs text-slate-400 font-medium">
			copyright ⓒ 봉동중앙교회 All rights reserved.<br>Provided By 하나님의사람
		</div>
	</div>
</div>

<script th:inline="javascript">
    function togglePassword() {
        const $pwdInput = $('#password');
        const $eyeIcon = $('#eyeIcon');

        if ($pwdInput.attr('type') === 'pwd') {
            // 비밀번호 보이기
            $pwdInput.attr('type', 'text');
            $eyeIcon.removeClass('fa-eye').addClass('fa-eye-slash');
        } else {
            // 비밀번호 숨기기
            $pwdInput.attr('type', 'password');
            $eyeIcon.removeClass('fa-eye-slash').addClass('fa-eye');
        }
    }

    $(function () {
        // 'savedMberId'라는 이름의 쿠키를 찾습니다.
        const savedId = Cookies.get('savedMberId');
        if (savedId) {
            $('#mberId').val(savedId); // HTML ID에 맞춰 #mberId로 수정
            $('#remember-me').prop('checked', true);
        }

        // 로그인 버튼 클릭 이벤트
        $('#login_do').on('click', function (e) {
            // 기본 submit 방지 (버튼이 form 안에 있을 경우 대비)
            e.preventDefault();

            const $mberIdInput = $('#mberId');
            const $pwdInput = $('#pwd');
            const $loginBtn = $(this);

            if ($mberIdInput.val() === "" || $pwdInput.val() === "") {
                //
                return;
            }

            if ($('#remember-me').is(':checked')) {
                // 7일 동안 유효한 쿠키 생성, 경로는 루트('/')로 설정
                Cookies.set('savedMberId', $mberIdInput.val(), {expires: 7, path: '/'});
            } else {
                // 쿠키 삭제
                Cookies.remove('savedMberId', {path: '/'});
            }

            // 로그인 요청
            $.ajax({
                type: "POST",
                url: /*[[@{/mng/idx/login.ax}]]*/ "/mng/idx/login.ax",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({mberId: $mberIdInput.val(), pwd: $pwdInput.val()}),
                success: (data) => {
                    if (data.rtnCd === '001') {
                        setTimeout(() => {
                            if (typeof _showToast === 'function') {
                                alert("반갑습니다, 관리자님! 환영합니다.");
                            }
                            setTimeout(() => {
                                location.href = /*[[@{/mng/home.pg}]]*/ "/mng/home.pg";
                            }, 500);
                        }, 500);
                    } else {
                        alert(data.rtnMsg);
                    }
                },
                error: (e) => {
                    alert("시스템 오류가 발생했습니다.");
                }
            });
        });
    });
</script>
</body>
</html>