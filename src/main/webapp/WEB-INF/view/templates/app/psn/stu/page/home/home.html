<!DOCTYPE html>
<html xmlns:th="http//www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{/app/psn/stu/layouts/std_layout}">
<th:block layout:fragment="content">
	<script th:inline="javascript">
		const StdHomeUI = {
			init: function () {
				this.cacheDOM();
				this.render();
			},
			cacheDOM: function () {
				this.$expBar = $('#exp-bar');
				this.$expText = $('#current-exp');
				this.$typingTarget = $('#typing-bible');
			},
			render: function () {
				this.animateExpBar(); // 1. ì´ˆê¸° ê²½í—˜ì¹˜ ë°” ì• ë‹ˆë©”ì´ì…˜
				const text = this.$typingTarget.html(); // HTML data-text ì†ì„±ì—ì„œ ê°€ì ¸ì˜´
				this.typeWriter(this.$typingTarget, text); // 2. ë§ì”€ íƒ€ì´í•‘ íš¨ê³¼ ì‹œì‘
			},
			/**
			 * ê²½í—˜ì¹˜ ë°” ì• ë‹ˆë©”ì´ì…˜
			 * data-current, data-max ì†ì„±ì„ í™œìš©í•˜ì—¬ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬
			 */
			animateExpBar: function () {
				// HTML íƒœê·¸ì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸° (ì˜ˆ: <span id="current-exp" data-current="60" data-max="100">)
				const current = this.$expText.data('current') || 0;
				const max = this.$expText.data('max') || 100;
				const percentage = Math.min((current / max) * 100, 100); // 100% ë„˜ì§€ ì•Šë„ë¡ ë°©ì§€
				// CSS ì´ˆê¸°í™” í›„ ì• ë‹ˆë©”ì´ì…˜
				this.$expBar.css('width', '0%');
				setTimeout(() => {
					this.$expBar.css({
						'width': percentage + '%',
						'transition': 'width 1s ease-out' // CSS transition í™œìš© (ë” ë¶€ë“œëŸ¬ì›€)
					});
				}, 100);
			},
			/**
			 * íƒ€ì´í•‘ íš¨ê³¼ (ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜)
			 * @param {jQuery} $element - ëŒ€ìƒ ìš”ì†Œ
			 * @param {String} text - íƒ€ì´í•‘í•  í…ìŠ¤íŠ¸
			 * @param {Number} speed - ì†ë„ (ms)
			 */
			typeWriter: function ($element, text, speed = 100) {
				if (!text) return;
				$element.text(''); // ì´ˆê¸°í™”
				let i = 0;
				function typing() {
					if (i < text.length) {
						$element.text(text.substring(0, i + 1));
						i++;
						setTimeout(typing, speed);
					}
				}
				typing();
			}
		};
		// ì‹¤í–‰
		$(function () {
			StdHomeUI.init();
		});
	</script>
	<div class="profile-card">
		<div style="display: flex; align-items: center; margin-bottom: 20px;">
			<div class="profile-avatar-wrap">
				<img th:src="|https://cdn.jsdelivr.net/gh/ysrim/bjcc_ss@main/images/avatar/${session.mberInfo.occpCode}_${#strings.toLowerCase(session.mberInfo.sexdstn)}.png|" alt="ë‚´ ìºë¦­í„°"
					 style="width:100%; height:100%; object-fit:cover; border-radius:18px;">
			</div>
			<div style="margin-left: 15px;">
				<div style="display: flex; gap: 5px;">
					<span class="user-rank-badge" style="background: #E3F2FD; color: #4A90E2;" th:text="|${guildInfo.guildNm} ê¸¸ë“œ|"></span>
					<span class="user-rank-badge" style="background: #FFF3E0; color: #EF6C00;"><span id="" th:text="|${_mberPoint}|">2,500</span> ë‹¬ë€íŠ¸</span>
				</div>
				<h2 style="font-size: 1.3rem; color: #333;" th:text="|Lv.${_mberLevel} ${session.mberInfo.ncnm}|"></h2>
			</div>
		</div>
		<div style="background: #FAFBFC; padding: 12px; border-radius: 15px;">
			<div style="display: flex; justify-content: space-between; font-size: 0.75rem; font-weight: bold; color: #777;">
				<span>ì„±ì¥ ê²½í—˜ì¹˜ (EXP)</span>
				<span><span id="current-exp" th:text="${_mberExp}" th:data-current="${_mberExp}"></span> / 100</span>
			</div>
			<div class="exp-container">
				<div id="exp-bar" class="exp-bar-fill" th:style="|width: ${_mberExp}%;|"></div>
			</div>
		</div>
	</div>
	<div class="card">
		<h4>ì˜¤ëŠ˜ì˜ ë§ì”€ ğŸ“–</h4>
		<p style="font-style:italic; min-height: 1.6em;">
			<span id="typing-bible"
				  th:text="|${todayBibleVerse.content} [${todayBibleVerse.bookName} ${todayBibleVerse.chapter}ì¥ ${todayBibleVerse.verseStart}ì ˆ]|">ë‚´ê²Œ ëŠ¥ë ¥ ì£¼ì‹œëŠ” ì ì•ˆì—ì„œ ë‚´ê°€ ëª¨ë“  ê²ƒì„ í•  ìˆ˜ ìˆëŠë‹ˆë¼
			</span>
		</p>
	</div>
	<div class="guild-section">
		<div class="guild-header">
			<div class="guild-name">
				<h4 style="color: #4A90E2;" th:text="|ğŸ›¡ï¸ ${guildInfo.guildNm}ê¸¸ë“œ|">ë‹¤ìœ—ì˜ ìš©ì‚¬ë“¤</h4>
				<span class="guild-tag" th:text="|LV.${guildInfo.guildLevel}|">LV.5</span>
			</div>
			<span style="font-size: 0.75rem; color: #666; font-weight: bold;" th:text="|ê¸¸ë“œì› ${guildMberAccessList.size()}/${guildMberCnt}|">ê¸¸ë“œì› 12/20</span>
		</div>
		<div style="margin-top: 10px;">
			<p style="font-size: 0.8rem; color: #666;">ê³µë™ í€˜ìŠ¤íŠ¸: ì´ë²ˆ ì£¼ ë§ì”€ 50ë²ˆ ì½ê¸°</p>
			<div style="width: 100%; height: 6px; background: #eee; border-radius: 10px; margin-top: 5px;">
				<div style="width: 75%; height: 100%; background: #4A90E2; border-radius: 10px;"></div>
			</div>
			<p style="text-align: right; font-size: 0.7rem; color: #999; margin-top: 3px;">75% ë‹¬ì„± ì¤‘</p>
		</div>
		<div class="guild-member-list">
			<div class="member-item" th:each="vo : ${guildMberAccessList}">
				<img th:src="|https://cdn.jsdelivr.net/gh/ysrim/bjcc_ss@main/images/avatar/${vo.occpCode}_${#strings.toLowerCase(vo.sexdstn)}.png|" class="member-avatar">
				<div class="member-info">
					<div class="member-name">[[${vo.ncnm}]] [[${vo.mberId == session.mberInfo.mberId ? '(ë‚˜)' : '('+session.mberInfo.mberNm+')'}]]</div>
					<div class="member-status">í˜„ì¬ ì ‘ì†ì¤‘</div>
				</div>
				<div style="text-align: right;">
					<div style="font-size: 0.8rem; font-weight: bold; color: #4A90E2;" th:text="|LV.${vo.level}|">Lv.15</div>
				</div>
			</div>
			<button style="width: 100%; padding: 10px; border: 1px dashed #DDD; background: none; border-radius: 15px; color: #999; font-size: 0.8rem; cursor: pointer;"
					th:onclick="|location.href='@{/std/gild.pg}'|">
				+ ê¸¸ë“œì› ë”ë³´ê¸°
			</button>
		</div>
	</div>
	<div class="card" style="margin-top:15px;">
		<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
			<h4 style="margin: 0;">ê³µì§€ì‚¬í•­ ğŸ“¢</h4>
		</div>
		<div class="notice-list">
			<div class="notice-item" th:onclick="|location.href='@{/std/home/noticeCont.pg}'|" style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; cursor: pointer;">
				<div style="display: flex; gap: 8px; align-items: center; margin-bottom: 4px;">
					<span style="background: #FFEBEB; color: #FF4D4D; font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; font-weight: bold;">ì¤‘ìš”</span>
					<span style="font-size: 0.9rem; font-weight: 700; color: #333;">ì´ë²ˆ ì£¼ ì£¼ì¼ ì•¼ì™¸ í™œë™ ì•ˆë‚´</span>
				</div>
				<p style="font-size: 0.8rem; color: #777; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">êµíšŒ ê·¼ì²˜ ê³µì›ì—ì„œ ë³´ë¬¼ì°¾ê¸°ê°€ ì§„í–‰ë©ë‹ˆë‹¤!</p>
			</div>
			<div class="notice-item" th:onclick="|location.href='@{/std/home/noticeCont.pg}'|" style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; cursor: pointer;">
				<div style="display: flex; gap: 8px; align-items: center; margin-bottom: 4px;">
					<span style="background: #E3F2FD; color: #2196F3; font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; font-weight: bold;">ì•ˆë‚´</span>
					<span style="font-size: 0.9rem; font-weight: 700; color: #333;">ìƒˆ ì¹œêµ¬ í™˜ì˜ íŒŒí‹° (ë‹¤ìŒ ì£¼)</span>
				</div>
				<p style="font-size: 0.8rem; color: #777; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">ìƒˆë¡œ ì˜¨ ì¹œêµ¬ë“¤ì„ ìœ„í•´ ë§›ìˆëŠ” ê°„ì‹ì´ ì¤€ë¹„ë˜ì–´ ìˆì–´ìš”.</p>
			</div>
			<div class="notice-item" th:onclick="|location.href='@{/std/home/noticeCont.pg}'|" style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; cursor: pointer;">
				<div style="display: flex; gap: 8px; align-items: center; margin-bottom: 4px;">
					<span style="background: #F5F5F5; color: #666; font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; font-weight: bold;">í•„ë…</span>
					<span style="font-size: 0.9rem; font-weight: 700; color: #333;">ë‹¬ë€íŠ¸ ì‹œì¥ ê°œìµœ ê³µì§€</span>
				</div>
				<p style="font-size: 0.8rem; color: #777; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">ì—´ì‹¬íˆ ëª¨ì€ ë‹¬ë€íŠ¸ë¥¼ ì‚¬ìš©í•  ì‹œê°„ì´ ì™”ìŠµë‹ˆë‹¤!</p>
			</div>
		</div>
	</div>
</th:block>
</html>