<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/app/psn/mng/layouts/mng_layout}" lang="ko">
<th:block layout:fragment="content">

	<script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>

	<style>
        /* ìŠ¤íƒ ë‹¤ë“œ ì—ë””ì…˜ ëª¨ë˜ ë¼ì´íŠ¸ í…Œë§ˆ ì»¤ìŠ¤í…€ */
        .ag-theme-quartz {
            --ag-header-background-color: #f8fafc;
            --ag-header-foreground-color: #475569;
            --ag-border-color: #e2e8f0;
            --ag-row-border-color: #f1f5f9;
            --ag-row-hover-color: #f0f9ff;
            --ag-font-size: 12px;
            --ag-font-family: inherit;
            --ag-header-column-separator-display: block;
            --ag-header-column-separator-color: #e2e8f0;
        }

        /* ê·¸ë¦¬ë“œ ë‚´ë¶€ì˜ ì»¤ìŠ¤í…€ ë Œë”ëŸ¬ ìˆ˜ì§ ì •ë ¬ì„ ìœ„í•œ ìŠ¤íƒ€ì¼ */
        .ag-cell-wrapper {
            display: flex;
            align-items: center;
            height: 100%;
        }
	</style>

	<div id="page-adjustment"
	     class="page-content w-full min-h-screen bg-[#f8f9fa] p-5 font-sans text-slate-600 animate-fade-in">

		<header class="mb-6">
			<span class="px-2.5 py-0.5 rounded-full bg-indigo-50 text-indigo-600 text-[10px] font-bold uppercase tracking-wider mb-1 inline-block">Rewards</span>
			<h1 class="text-2xl font-black text-slate-900 tracking-tight">Manual Adjustment</h1>
			<p class="text-xs text-slate-500 mt-1 font-medium">í•™ìƒë“¤ì—ê²Œ ê²½í—˜ì¹˜(EXP)ë‚˜ í¬ì¸íŠ¸(Gold)ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì§€ê¸‰í•˜ê±°ë‚˜ ì°¨ê°í•©ë‹ˆë‹¤.</p>
		</header>

		<div class="grid grid-cols-1 lg:grid-cols-3 gap-5">
			<div class="lg:col-span-1">
				<div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm sticky top-5">
					<h2 class="text-sm font-black text-slate-800 flex items-center border-b border-slate-100 pb-3 mb-5">
						<i class="fas fa-sliders-h text-indigo-500 mr-2"></i> ì§€ê¸‰ ì„¤ì •
					</h2>

					<form class="space-y-5" onsubmit="return false;">
						<div>
							<label class="form-label">ëŒ€ìƒ í•™ìƒ <span class="text-red-500">*</span></label>
							<div class="relative group">
								<input type="hidden" id="selectedStudentId">
								<input type="text" id="targetStudentDisplay"
								       class="form-input pr-9 cursor-pointer hover:bg-slate-50"
								       placeholder="ì´ë¦„ ê²€ìƒ‰ (í´ë¦­)" onclick="openStudentModal()" readonly>
								<button type="button" onclick="openStudentModal()"
								        class="absolute right-3 top-2.5 text-slate-400 hover:text-indigo-600 transition">
									<i class="fas fa-search"></i>
								</button>
							</div>
						</div>

						<div>
							<label class="form-label">ì§€ê¸‰ ìœ í˜• <span class="text-red-500">*</span></label>
							<div class="grid grid-cols-2 gap-3">
								<label class="cursor-pointer group">
									<input type="radio" name="rewardType" class="peer sr-only radio-card-input" checked>
									<div class="radio-card text-center py-3 rounded-xl border border-slate-200 transition-all group-hover:bg-slate-50">
										<i class="fas fa-star mb-1 block text-sm"></i>
										<span class="text-xs font-bold">ê²½í—˜ì¹˜ (EXP)</span>
									</div>
								</label>
								<label class="cursor-pointer group">
									<input type="radio" name="rewardType" class="peer sr-only radio-card-input">
									<div class="radio-card amber text-center py-3 rounded-xl border border-slate-200 transition-all group-hover:bg-slate-50">
										<i class="fas fa-coins mb-1 block text-sm"></i>
										<span class="text-xs font-bold">í¬ì¸íŠ¸ (Gold)</span>
									</div>
								</label>
							</div>
						</div>

						<div>
							<label class="form-label">ì¡°ì • ë°©ì‹</label>
							<div class="flex p-1 bg-slate-100 rounded-xl">
								<label class="flex-1 cursor-pointer">
									<input type="radio" name="actionType" class="peer sr-only" checked>
									<div class="text-center py-2 rounded-lg text-xs font-bold text-slate-500 peer-checked:bg-white peer-checked:text-indigo-600 peer-checked:shadow-sm transition-all">
										<i class="fas fa-plus mr-1"></i> ì§€ê¸‰ (Add)
									</div>
								</label>
								<label class="flex-1 cursor-pointer">
									<input type="radio" name="actionType" class="peer sr-only">
									<div class="text-center py-2 rounded-lg text-xs font-bold text-slate-500 peer-checked:bg-white peer-checked:text-red-600 peer-checked:shadow-sm transition-all">
										<i class="fas fa-minus mr-1"></i> ì°¨ê° (Sub)
									</div>
								</label>
							</div>
						</div>

						<div class="grid grid-cols-3 gap-3">
							<div class="col-span-1">
								<label class="form-label">ìˆ˜ëŸ‰</label>
								<input type="number" class="form-input text-center font-bold" placeholder="0">
							</div>
							<div class="col-span-2">
								<label class="form-label">ì‚¬ìœ </label>
								<input type="text" class="form-input" placeholder="ì˜ˆ: ì‹¬ë¶€ë¦„ ë³´ìƒ">
							</div>
						</div>

						<button type="button"
						        class="w-full bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-200 hover:shadow-xl transition-all text-xs flex items-center justify-center transform active:scale-95">
							<i class="fas fa-check-circle mr-2"></i> ì„¤ì • ì ìš©í•˜ê¸°
						</button>
					</form>
				</div>
			</div>

			<div class="lg:col-span-2">
				<div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm h-full flex flex-col">
					<div class="mb-5 flex justify-between items-center">
						<h2 class="text-sm font-black text-slate-800 flex items-center">
							<i class="fas fa-history text-slate-400 mr-2"></i> ìµœê·¼ ì¡°ì • ë‚´ì—­
						</h2>

						<div class="flex items-center gap-2">
							<div class="relative group">
								<input type="text" id="tableSearchInput" placeholder="ë‚´ì—­ ê²€ìƒ‰..."
								       class="pl-8 pr-3 py-1.5 bg-slate-50 border border-slate-200 rounded-lg text-[10px] font-bold outline-none focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 w-32 transition">
								<i class="fas fa-search absolute left-2.5 top-2 text-slate-400 text-[10px] group-hover:text-indigo-500 transition-colors"></i>
							</div>
							<div class="h-4 w-px bg-slate-200"></div>
							<button id="btnExport" class="text-[10px] font-bold text-slate-500 bg-slate-100 hover:bg-slate-200 px-2.5 py-1.5 rounded-lg transition flex items-center">
								<i class="fas fa-file-excel text-green-600 mr-1.5"></i> ì—‘ì…€
							</button>
						</div>
					</div>

					<div id="adjustmentGrid" class="ag-theme-quartz flex-1 min-h-[400px] rounded-xl overflow-hidden border border-slate-100"></div>
				</div>
			</div>
		</div>
	</div>

	<div id="studentModal" class="fixed inset-0 z-50 hidden">
		<div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity"
		     onclick="closeStudentModal()"></div>

		<div class="relative w-full max-w-md mx-auto mt-20 bg-white rounded-2xl shadow-2xl modal-enter overflow-hidden flex flex-col max-h-[80vh]">
			<div class="p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50">
				<h3 class="text-sm font-black text-slate-800">í•™ìƒ ê²€ìƒ‰</h3>
				<button onclick="closeStudentModal()" class="text-slate-400 hover:text-slate-600 transition"><i
						class="fas fa-times"></i></button>
			</div>

			<div class="p-4 border-b border-slate-100">
				<div class="relative">
					<input type="text" id="modalSearchInput" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ê¹€ì² ìˆ˜)"
					       class="w-full pl-10 pr-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-indigo-100 focus:border-indigo-500 outline-none">
					<i class="fas fa-search absolute left-4 top-3.5 text-slate-400"></i>
				</div>
			</div>

			<div class="overflow-y-auto p-2 flex-1 min-h-[300px]" id="studentListContainer">
			</div>
		</div>
	</div>

	<script th:inline="javascript">
		// ==========================================
		// 1. ë°ì´í„° ì •ì˜ (ë”ë¯¸ ë°ì´í„°)
		// ==========================================
		const adjustmentData = [
			{time: '10:42 AM', name: 'ê¹€ì² ìˆ˜', content: 'íŠ¹ë³„ ì‹¬ë¶€ë¦„ ë³´ìƒ', change: '+50 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: '09:15 AM', name: 'ì´ì˜í¬', content: 'ìƒì  ì•„ì´í…œ êµ¬ë§¤', change: '-200 Gold', type: 'gold-minus', admin: 'System'},
			{time: '08:30 AM', name: 'ë°•ë¯¼ìˆ˜', content: 'ì•„ì¹¨ íí‹° ì°¸ì„', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
			{time: 'ì–´ì œ', name: 'ìµœìœ ë¦¬', content: 'ì¹œêµ¬ ì „ë„', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: 'ì–´ì œ', name: 'ê°•í˜¸ë™', content: 'ì§€ê° í˜ë„í‹°', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: '08:30 AM', name: 'ë°•ë¯¼ìˆ˜', content: 'ì•„ì¹¨ íí‹° ì°¸ì„', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
			{time: 'ì–´ì œ', name: 'ìµœìœ ë¦¬', content: 'ì¹œêµ¬ ì „ë„', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: 'ì–´ì œ', name: 'ê°•í˜¸ë™', content: 'ì§€ê° í˜ë„í‹°', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: '08:30 AM', name: 'ë°•ë¯¼ìˆ˜', content: 'ì•„ì¹¨ íí‹° ì°¸ì„', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
			{time: 'ì–´ì œ', name: 'ìµœìœ ë¦¬', content: 'ì¹œêµ¬ ì „ë„', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: 'ì–´ì œ', name: 'ê°•í˜¸ë™', content: 'ì§€ê° í˜ë„í‹°', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: '09:15 AM', name: 'ì´ì˜í¬', content: 'ìƒì  ì•„ì´í…œ êµ¬ë§¤', change: '-200 Gold', type: 'gold-minus', admin: 'System'},
			{time: '08:30 AM', name: 'ë°•ë¯¼ìˆ˜', content: 'ì•„ì¹¨ íí‹° ì°¸ì„', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
			{time: 'ì–´ì œ', name: 'ìµœìœ ë¦¬', content: 'ì¹œêµ¬ ì „ë„', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: 'ì–´ì œ', name: 'ê°•í˜¸ë™', content: 'ì§€ê° í˜ë„í‹°', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: '08:30 AM', name: 'ë°•ë¯¼ìˆ˜', content: 'ì•„ì¹¨ íí‹° ì°¸ì„', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
			{time: 'ì–´ì œ', name: 'ìµœìœ ë¦¬', content: 'ì¹œêµ¬ ì „ë„', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: 'ì–´ì œ', name: 'ê°•í˜¸ë™', content: 'ì§€ê° í˜ë„í‹°', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: '08:30 AM', name: 'ë°•ë¯¼ìˆ˜', content: 'ì•„ì¹¨ íí‹° ì°¸ì„', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
			{time: 'ì–´ì œ', name: 'ìµœìœ ë¦¬', content: 'ì¹œêµ¬ ì „ë„', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
			{time: 'ì–´ì œ', name: 'ê°•í˜¸ë™', content: 'ì§€ê° í˜ë„í‹°', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: 'ì–´ì œ', name: 'ìœ ì¬ì„', content: 'ë°˜ì¥ ì„ ì¶œ ë³´ë„ˆìŠ¤', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
			{time: '2ì¼ ì „', name: 'ê¹€ì² ìˆ˜', content: 'ì¤€ë¹„ë¬¼ ë¯¸ì§€ì°¸', change: '-50 Gold', type: 'gold-minus', admin: 'T.Lee'},
		];

		const studentList = [
			{id: 'hong_123', name: 'í™ê¸¸ë™', grade: '3', class: 'ë¯¿ìŒ', job: 'ì „ì‚¬', avatar: 'Felix'},
			{id: 'kim_chul', name: 'ê¹€ì² ìˆ˜', grade: '3', class: 'ë¯¿ìŒ', job: 'ë§ˆë²•ì‚¬', avatar: 'Aneka'},
			{id: 'lee_young', name: 'ì´ì˜í¬', grade: '3', class: 'ì†Œë§', job: 'ê¶ìˆ˜', avatar: 'Bob'},
			{id: 'park_min', name: 'ë°•ë¯¼ìˆ˜', grade: '3', class: 'ì‚¬ë‘', job: 'ë„ì ', avatar: 'Jack'},
			{id: 'choi_yuri', name: 'ìµœìœ ë¦¬', grade: '2', class: 'ì†Œë§', job: 'ì„±ì§ì', avatar: 'Molly'},
			{id: 'kang_ho', name: 'ê°•í˜¸ë™', grade: '1', class: 'ë¯¿ìŒ', job: 'ì „ì‚¬', avatar: 'Bear'},
		];

		// ==========================================
		// 2. ëª¨ë‹¬ ê´€ë ¨ ë¡œì§
		// ==========================================
		function openStudentModal() {
			$('#studentModal').removeClass('hidden');
			$('#modalSearchInput').val('').focus();
			renderStudentList(studentList);
		}

		function closeStudentModal() {
			$('#studentModal').addClass('hidden');
		}

		function selectStudent(id, name, info) {
			$('#targetStudentDisplay').val(`${name} (${info})`);
			$('#selectedStudentId').val(id);
			closeStudentModal();
		}

		function renderStudentList(data) {
			const container = $('#studentListContainer');
			container.empty();

			if (data.length === 0) {
				container.html(`<div class="text-center py-10 text-slate-400 text-xs">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`);
				return;
			}

			data.forEach(student => {
				const html = `
                    <div onclick="selectStudent('${student.id}', '${student.name}', '${student.grade}í•™ë…„ ${student.class}ë°˜')"
                         class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition border border-transparent hover:border-indigo-100 group">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=${student.avatar}" class="w-10 h-10 rounded-full bg-white border border-slate-200">
                        <div>
                            <div class="font-bold text-sm text-slate-800 group-hover:text-indigo-600">${student.name}</div>
                            <div class="text-[10px] text-slate-400 font-medium">${student.grade}í•™ë…„ ${student.class}ë°˜ Â· ${student.job}</div>
                        </div>
                        <i class="fas fa-chevron-right ml-auto text-slate-300 text-xs group-hover:text-indigo-400"></i>
                    </div>
                `;
				container.append(html);
			});
		}

		// ==========================================
		// 3. ag-Grid ì»¤ìŠ¤í…€ ë Œë”ëŸ¬
		// ==========================================
		function changeRenderer(params) {
			if (!params.data) return '';
			const type = params.data.type;
			const change = params.value;

			let badgeClass = "";
			if (type.includes('exp-plus')) badgeClass = "bg-indigo-50 text-indigo-600 border-indigo-100";
			else if (type.includes('gold-plus')) badgeClass = "bg-amber-50 text-amber-600 border-amber-100";
			else if (type.includes('minus')) badgeClass = "bg-red-50 text-red-500 border-red-100";

			return `
                <div class="flex items-center justify-center w-full h-full">
                    <span class="${badgeClass} border px-2 py-0.5 rounded text-[10px] font-bold inline-block min-w-[70px] text-center">
                        ${change}
                    </span>
                </div>
            `;
		}

		function adminRenderer(params) {
			if (!params.value) return '';
			return `
                <div class="flex items-center justify-center w-full h-full">
                    <span class="px-2 py-0.5 rounded bg-slate-100 text-slate-500 text-[10px] font-bold hover:bg-indigo-50 hover:text-indigo-500 transition cursor-default">
                        ${params.value}
                    </span>
                </div>
            `;
		}

		// ==========================================
		// 4. ì´ë²¤íŠ¸ ë°”ì¸ë”© ë° ê·¸ë¦¬ë“œ ì´ˆê¸°í™” (jQuery ìµœì í™”)
		// ==========================================
		$(function () {
			// ëª¨ë‹¬ ê²€ìƒ‰ ì´ë²¤íŠ¸ ë°”ì¸ë”©
			$('#modalSearchInput').on('input', function () {
				const keyword = $(this).val().toLowerCase();
				const filtered = studentList.filter(s =>
					s.name.includes(keyword) || s.id.includes(keyword)
				);
				renderStudentList(filtered);
			});

			// ag-Grid ì»¬ëŸ¼ ë° ì˜µì…˜ ì„¤ì •
			const columnDefs = [
				{headerName: "ì‹œê°„", field: "time", width: 90, cellStyle: {color: '#94a3b8', fontSize: '10px', fontFamily: 'monospace'}},
				{headerName: "ëŒ€ìƒ", field: "name", width: 100, filter: true, cellStyle: {fontWeight: 'bold', color: '#334155'}},
				{headerName: "ë‚´ìš©", field: "content", flex: 1, minWidth: 150},
				{headerName: "ë³€ë™ê°’", field: "change", cellRenderer: changeRenderer, width: 120},
				{headerName: "ë‹´ë‹¹ì", field: "admin", cellRenderer: adminRenderer, width: 100}
			];

			const gridOptions = {
				columnDefs: columnDefs,
				rowData: adjustmentData,
				defaultColDef: {
					resizable: true,
					sortable: true
				},
				pagination: true,
				paginationPageSize: 10,  // ì‹œì‘ ë°ì´í„° ê°œìˆ˜ (ê¸°ë³¸ 10ê°œ)
				paginationPageSizeSelector: [10, 20, 50, 100],  // ğŸš€ ì´ ë¶€ë¶„ì´ ì¶”ê°€ëœ ì†ì„±ì…ë‹ˆë‹¤!
				headerHeight: 35,
				rowHeight: 33,
				domLayout: 'autoHeight'
			};

			// ê·¸ë¦¬ë“œ ìƒì„± (ag-GridëŠ” ìˆœìˆ˜ DOM ê°ì²´ë¥¼ í•„ìš”ë¡œ í•˜ë¯€ë¡œ [0] ì‚¬ìš©)
			const gridDiv = $('#adjustmentGrid')[0];
			const gridApi = agGrid.createGrid(gridDiv, gridOptions);

			// ê·¸ë¦¬ë“œ ê²€ìƒ‰ ì´ë²¤íŠ¸ ë°”ì¸ë”©
			$('#tableSearchInput').on('input', function () {
				gridApi.setGridOption('quickFilterText', $(this).val());
			});

			// ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì´ë²¤íŠ¸ ë°”ì¸ë”©
			$('#btnExport').on('click', function () {
				gridApi.exportDataAsCsv({
					fileName: 'í•™ìƒ_í¬ì¸íŠ¸_ê²½í—˜ì¹˜_ì¡°ì •ë‚´ì—­.csv',
					columnSeparator: ',',
					processCellCallback: function (params) {
						return params.value;
					}
				});
			});
		});
	</script>
</th:block>
</html>