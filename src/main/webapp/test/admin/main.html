<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG 성소 - 통합 관리자</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/airbnb.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/ko.js"></script>
    <style>
        /* 1. 폰트 불러오기 (Pretendard) */
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

        /* 2. 기본 설정 */
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Malgun Gothic', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* 3. 유틸리티 클래스 */
        /* 화면 전환 시 페이지를 숨기는 클래스 */
        .hidden-page {
            display: none !important;
        }

        /* 4. 커스텀 스크롤바 디자인 */
        /* 스크롤바 전체 폭 */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        /* 스크롤바 배경 (투명) */
        ::-webkit-scrollbar-track {
            background: transparent;
        }

        /* 스크롤바 막대 (회색) */
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        /* 스크롤바 막대 호버 효과 (진한 회색) */
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Firefox 전용 스크롤바 설정 */
        * {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 transparent;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-600">
<div id="loading-container" class="fixed top-0 left-0 w-full h-1 z-50 hidden">
    <div id="loading-bar" class="h-full bg-indigo-600 transition-all duration-500 ease-out" style="width: 0%"></div>
</div>

<div class="flex h-screen overflow-hidden">

    <aside class="w-64 bg-white border-r border-slate-200 flex flex-col z-10">
        <div class="h-16 flex items-center px-6 border-b border-slate-100">
            <div class="text-xl font-bold text-slate-800 flex items-center">
                <i class="fas fa-chess-rook mr-3 text-indigo-600"></i> RPG Admin
            </div>
        </div>

        <nav class="flex-1 p-4 space-y-1">
            <button onclick="showPage('dashboard', this)"
                    class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors bg-slate-100 text-indigo-700">
                <i class="fas fa-home mr-3 w-5 text-center"></i> 대시보드
            </button>
            <button onclick="showPage('members', this)"
                    class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                <i class="fas fa-users mr-3 w-5 text-center"></i> 용사(회원) 관리
            </button>
            <button onclick="showPage('notice', this)"
                    class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                <i class="fas fa-bullhorn mr-3 w-5 text-center"></i> 공지사항 관리
            </button>
            <button onclick="showPage('adjustment', this)"
                    class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                <i class="fas fa-magic mr-3 w-5 text-center"></i> 포인트/보상 관리
            </button>
			<button onclick="showPage('quest', this)"
        class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
    <i class="fas fa-scroll mr-3 w-5 text-center"></i> 퀘스트 승인
    <span class="ml-auto bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full">N</span>
</button>
        </nav>

        <div class="p-4 border-t border-slate-100">
            <button class="flex items-center text-sm font-medium text-slate-500 hover:text-red-600 transition-colors w-full px-4 py-2">
                <i class="fas fa-sign-out-alt mr-3"></i> 로그아웃
            </button>
        </div>
    </aside>

    <main class="flex-1 overflow-y-auto h-full">
        <div class="p-8 max-w-7xl mx-auto">

            <div id="page-dashboard" class="page-content">
                <header class="flex justify-between items-end mb-8">
                    <div>
                        <h1 class="text-2xl font-bold text-slate-800">왕국 통계 현황</h1>
                        <p class="text-sm text-slate-500 mt-1">아이들의 활동 데이터를 한눈에 확인하세요.</p>
                    </div>

                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                            <i class="far fa-calendar-alt text-slate-400"></i>
                        </div>
                        <input type="text" id="dateRangePicker"
                               class="bg-white border border-slate-200 text-slate-700 text-sm rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 block w-60 pl-10 p-2 shadow-sm transition outline-none"
                               placeholder="기간 선택">
                    </div>
                </header>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-indigo-50 rounded-lg text-indigo-600">
                                <i class="fas fa-chart-line text-lg"></i>
                            </div>
                            <span class="text-xs font-medium px-2 py-1 bg-green-50 text-green-600 rounded-full flex items-center">
                                <i class="fas fa-arrow-up mr-1 text-[10px]"></i> 3.2%
                            </span>
                        </div>
                        <h3 class="text-2xl font-bold text-slate-800">92.4%</h3>
                        <p class="text-sm text-slate-400 mt-1">금주 출석률</p>
                    </div>

                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-emerald-50 rounded-lg text-emerald-600">
                                <i class="fas fa-check-circle text-lg"></i>
                            </div>
                            <span class="text-xs font-medium px-2 py-1 bg-green-50 text-green-600 rounded-full flex items-center">
                                <i class="fas fa-arrow-up mr-1 text-[10px]"></i> 12%
                            </span>
                        </div>
                        <h3 class="text-2xl font-bold text-slate-800">128건</h3>
                        <p class="text-sm text-slate-400 mt-1">퀘스트 완료</p>
                    </div>

                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-orange-50 rounded-lg text-orange-600">
                                <i class="fas fa-user-plus text-lg"></i>
                            </div>
                            <span class="text-xs font-medium px-2 py-1 bg-red-50 text-red-500 rounded-full flex items-center">
                                <i class="fas fa-arrow-down mr-1 text-[10px]"></i> 1명
                            </span>
                        </div>
                        <h3 class="text-2xl font-bold text-slate-800">5명</h3>
                        <p class="text-sm text-slate-400 mt-1">신규 등록 용사</p>
                    </div>

                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-purple-50 rounded-lg text-purple-600">
                                <i class="fas fa-coins text-lg"></i>
                            </div>
                            <span class="text-xs font-medium text-slate-400">이번 달 누적</span>
                        </div>
                        <h3 class="text-2xl font-bold text-slate-800">45,000 G</h3>
                        <p class="text-sm text-slate-400 mt-1">지급된 보상</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-base font-bold text-slate-800">📅 주간 출석 추이</h2>
                            <button class="text-xs text-indigo-600 font-semibold hover:bg-indigo-50 px-2 py-1 rounded transition">
                                상세보기
                            </button>
                        </div>
                        <div id="attendanceChart" class="w-full h-80"></div>
                    </div>

                    <div class="lg:col-span-1 bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                        <h2 class="text-base font-bold text-slate-800 mb-6">🏫 반별 출석 점유율</h2>
                        <div id="classChart" class="w-full flex justify-center mb-4"></div>

                        <div class="space-y-3 pt-4 border-t border-slate-100">
                            <div class="flex justify-between items-center text-sm">
                                <div class="flex items-center text-slate-600"><span
                                        class="w-2.5 h-2.5 rounded-full bg-indigo-500 mr-2"></span> 믿음반
                                </div>
                                <span class="font-semibold text-slate-800">45% (12명)</span>
                            </div>
                            <div class="flex justify-between items-center text-sm">
                                <div class="flex items-center text-slate-600"><span
                                        class="w-2.5 h-2.5 rounded-full bg-teal-400 mr-2"></span> 소망반
                                </div>
                                <span class="font-semibold text-slate-800">35% (9명)</span>
                            </div>
                            <div class="flex justify-between items-center text-sm">
                                <div class="flex items-center text-slate-600"><span
                                        class="w-2.5 h-2.5 rounded-full bg-amber-400 mr-2"></span> 사랑반
                                </div>
                                <span class="font-semibold text-slate-800">20% (5명)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                        <h2 class="text-base font-bold text-slate-800 mb-4">📜 요일별 퀘스트 수행</h2>
                        <div id="questChart" class="w-full h-64"></div>
                    </div>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-base font-bold text-slate-800 flex items-center">
                                <i class="fas fa-crown text-amber-400 mr-2"></i> 금주의 MVP
                            </h2>
                            <span class="text-xs font-medium bg-slate-100 text-slate-600 px-2 py-1 rounded">EXP 랭킹 기준</span>
                        </div>

                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 rounded-lg border border-indigo-100 bg-indigo-50/50">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-amber-400 text-white font-bold flex items-center justify-center shadow-sm text-sm">
                                        1
                                    </div>
                                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix"
                                         class="w-10 h-10 rounded-full bg-white border border-slate-200">
                                    <div>
                                        <div class="font-bold text-sm text-slate-800">김철수 (전사)</div>
                                        <div class="text-xs text-slate-500">1,200 EXP</div>
                                    </div>
                                </div>
                                <i class="fas fa-medal text-amber-400 text-lg"></i>
                            </div>

                            <div class="flex items-center justify-between p-3 rounded-lg border border-slate-100 hover:bg-slate-50 transition">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-slate-200 text-slate-500 font-bold flex items-center justify-center text-sm">
                                        2
                                    </div>
                                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka"
                                         class="w-10 h-10 rounded-full bg-white border border-slate-200">
                                    <div>
                                        <div class="font-bold text-sm text-slate-800">이영희 (마법사)</div>
                                        <div class="text-xs text-slate-500">980 EXP</div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex items-center justify-between p-3 rounded-lg border border-slate-100 hover:bg-slate-50 transition">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-amber-700/20 text-amber-800 font-bold flex items-center justify-center text-sm">
                                        3
                                    </div>
                                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Bob"
                                         class="w-10 h-10 rounded-full bg-white border border-slate-200">
                                    <div>
                                        <div class="font-bold text-sm text-slate-800">박민수 (궁수)</div>
                                        <div class="text-xs text-slate-500">850 EXP</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-notice" class="page-content hidden-page">
                <header class="flex justify-between items-center mb-8">
                    <h1 class="text-2xl font-bold text-slate-800">게시판 관리</h1>
                    <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-indigo-700 transition shadow-sm hover:shadow"
                            onclick="showPage('notice-write')">
                        <i class="fas fa-pen mr-2"></i> 공지 작성
                    </button>
                </header>

                <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                        <div class="flex space-x-2">
                            <select class="border border-slate-300 rounded-md px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 text-slate-600 bg-white">
                                <option>전체보기</option>
                                <option>공지사항</option>
                                <option>이벤트</option>
                            </select>
                        </div>
                        <div class="relative">
                            <input type="text" placeholder="제목 검색..."
                                   class="pl-9 pr-4 py-1.5 border border-slate-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 w-64">
                            <i class="fas fa-search absolute left-3 top-2.5 text-slate-400 text-xs"></i>
                        </div>
                    </div>
                    <table class="w-full text-left">
                        <thead class="bg-slate-50 text-slate-500 text-xs uppercase font-semibold">
                        <tr>
                            <th class="py-3 px-4 w-16 text-center">번호</th>
                            <th class="py-3 px-4 w-24 text-center">분류</th>
                            <th class="py-3 px-4">제목</th>
                            <th class="py-3 px-4 w-32 text-center">작성일</th>
                            <th class="py-3 px-4 w-20 text-center">조회</th>
                            <th class="py-3 px-4 w-24 text-center">관리</th>
                        </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100 text-sm text-slate-700">
                        <tr class="hover:bg-slate-50 transition">
                            <td class="py-3 px-4 text-center text-slate-400">3</td>
                            <td class="py-3 px-4 text-center"><span
                                    class="bg-red-50 text-red-600 border border-red-100 px-2 py-0.5 rounded text-xs font-medium">긴급</span>
                            </td>
                            <td class="py-3 px-4 font-medium text-slate-800 cursor-pointer hover:text-indigo-600">이번 주
                                주일예배 시간 변경 안내
                            </td>
                            <td class="py-3 px-4 text-center text-slate-500">2026-01-25</td>
                            <td class="py-3 px-4 text-center text-slate-500">124</td>
                            <td class="py-3 px-4 text-center">
                                <button class="text-slate-400 hover:text-indigo-600 p-1"><i class="fas fa-edit"></i>
                                </button>
                            </td>
                        </tr>
                        <tr class="hover:bg-slate-50 transition">
                            <td class="py-3 px-4 text-center text-slate-400">2</td>
                            <td class="py-3 px-4 text-center"><span
                                    class="bg-blue-50 text-blue-600 border border-blue-100 px-2 py-0.5 rounded text-xs font-medium">이벤트</span>
                            </td>
                            <td class="py-3 px-4 font-medium text-slate-800 cursor-pointer hover:text-indigo-600">달란트 시장
                                개최 안내 (2/14)
                            </td>
                            <td class="py-3 px-4 text-center text-slate-500">2026-01-20</td>
                            <td class="py-3 px-4 text-center text-slate-500">89</td>
                            <td class="py-3 px-4 text-center">
                                <button class="text-slate-400 hover:text-indigo-600 p-1"><i class="fas fa-edit"></i>
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="p-3 border-t border-slate-100 flex justify-center items-center space-x-1 text-sm">
                        <button class="px-2 py-1 text-slate-400 hover:text-indigo-600 disabled:opacity-50"><i
                                class="fas fa-chevron-left"></i></button>
                        <button class="px-3 py-1 font-semibold text-indigo-600 bg-indigo-50 rounded">1</button>
                        <button class="px-3 py-1 text-slate-500 hover:bg-slate-100 rounded">2</button>
                        <button class="px-2 py-1 text-slate-400 hover:text-indigo-600"><i
                                class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <div id="page-adjustment" class="page-content hidden-page">
                <header class="mb-8">
                    <h1 class="text-2xl font-bold text-slate-800">보상 수동 지급</h1>
                    <p class="text-sm text-slate-500 mt-1">경험치(EXP)나 포인트(Gold)를 직접 관리합니다.</p>
                </header>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1">
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h2 class="text-base font-bold mb-5 text-slate-800 border-b border-slate-100 pb-2">지급
                                설정</h2>
                            <form class="space-y-5">
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">대상 학생</label>
                                    <div class="relative">
                                        <input type="text"
                                               class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                                               placeholder="이름 검색">
                                        <button type="button"
                                                class="absolute right-3 top-2.5 text-slate-400 hover:text-indigo-600"><i
                                                class="fas fa-search"></i></button>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">지급 유형</label>
                                    <div class="grid grid-cols-2 gap-3">
                                        <label class="cursor-pointer">
                                            <input type="radio" name="type" class="peer sr-only" checked>
                                            <div class="text-center py-2.5 text-sm border border-slate-200 rounded-lg peer-checked:border-indigo-500 peer-checked:bg-indigo-50 peer-checked:text-indigo-700 transition text-slate-600 hover:bg-slate-50">
                                                <i class="fas fa-star mr-1"></i> 경험치
                                            </div>
                                        </label>
                                        <label class="cursor-pointer">
                                            <input type="radio" name="type" class="peer sr-only">
                                            <div class="text-center py-2.5 text-sm border border-slate-200 rounded-lg peer-checked:border-amber-500 peer-checked:bg-amber-50 peer-checked:text-amber-700 transition text-slate-600 hover:bg-slate-50">
                                                <i class="fas fa-coins mr-1"></i> 포인트
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">조정 방식</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="action"
                                                   class="text-indigo-600 focus:ring-indigo-500 w-4 h-4" checked>
                                            <span class="ml-2 text-sm text-slate-700">지급 (Add)</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="action"
                                                   class="text-red-600 focus:ring-red-500 w-4 h-4">
                                            <span class="ml-2 text-sm text-slate-700">차감 (Remove)</span>
                                        </label>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">수량</label>
                                    <input type="number"
                                           class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                                           placeholder="0">
                                </div>

                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">사유</label>
                                    <input type="text"
                                           class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                                           placeholder="예: 친구 전도 보너스">
                                </div>

                                <button type="button"
                                        class="w-full bg-indigo-600 text-white font-bold py-2.5 rounded-lg hover:bg-indigo-700 shadow-sm hover:shadow transition text-sm">
                                    적용하기
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="lg:col-span-2">
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-full flex flex-col">
                            <div class="mb-4 flex justify-between items-center">
                                <h2 class="text-base font-bold text-slate-800">최근 조정 내역</h2>
                                <button class="text-xs text-indigo-600 hover:underline">엑셀 다운로드</button>
                            </div>

                            <div class="overflow-x-auto flex-1 mb-4">
                                <table class="w-full text-left">
                                    <thead class="text-xs text-slate-500 uppercase bg-slate-50/50 border-b border-slate-100">
                                    <tr>
                                        <th class="px-4 py-3 font-semibold">시간</th>
                                        <th class="px-4 py-3 font-semibold">대상</th>
                                        <th class="px-4 py-3 font-semibold">내용</th>
                                        <th class="px-4 py-3 font-semibold">변동값</th>
                                        <th class="px-4 py-3 font-semibold">담당자</th>
                                    </tr>
                                    </thead>
                                    <tbody id="adjustmentTableBody" class="text-sm divide-y divide-slate-100">
                                    </tbody>
                                </table>
                            </div>

                            <div class="border-t border-slate-100 pt-4 flex justify-center items-center space-x-1 text-sm"
                                 id="adjustmentPagination">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-members" class="page-content hidden-page">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-2xl font-bold text-slate-800">용사 관리</h1>
                        <p class="text-sm text-slate-500 mt-1">학생 정보 조회 및 수정</p>
                    </div>
                    <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-indigo-700 shadow-sm transition flex items-center">
                        <i class="fas fa-user-plus mr-2"></i> 신규 등록
                    </button>
                </header>

                <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm mb-6 flex flex-wrap gap-4 justify-between items-center">
                    <div class="flex gap-2">
                        <select class="border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none bg-white text-slate-600">
                            <option value="">학년 전체</option>
                            <option value="1">1학년</option>
                            <option value="2">2학년</option>
                            <option value="3">3학년</option>
                        </select>
                        <select class="border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none bg-white text-slate-600">
                            <option value="">반 전체</option>
                            <option value="믿음">믿음반</option>
                            <option value="소망">소망반</option>
                            <option value="사랑">사랑반</option>
                        </select>
                    </div>
                    <div class="relative w-full md:w-64">
                        <input type="text" placeholder="이름/ID 검색"
                               class="w-full pl-9 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none">
                        <i class="fas fa-search absolute left-3 top-2.5 text-slate-400 text-xs"></i>
                    </div>
                </div>

                <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-slate-50 text-slate-500 text-xs uppercase font-semibold">
                        <tr>
                            <th class="p-4">용사 정보</th>
                            <th class="p-4">소속</th>
                            <th class="p-4">성장 (LV / EXP)</th>
                            <th class="p-4">자산</th>
                            <th class="p-4">연락처</th>
                            <th class="p-4 text-center">관리</th>
                        </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100 text-sm text-slate-700">
                        <tr class="hover:bg-slate-50 transition">
                            <td class="p-4 flex items-center gap-3">
                                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix"
                                     class="w-9 h-9 rounded-full bg-slate-100 border border-slate-200">
                                <div>
                                    <div class="font-bold text-slate-800">김철수 <span
                                            class="text-xs text-slate-400 font-normal">(@cs_kim)</span></div>
                                    <span class="inline-flex items-center text-xs font-medium text-slate-500">
                                        <i class="fas fa-sword mr-1 text-slate-400"></i> 전사
                                    </span>
                                </div>
                            </td>
                            <td class="p-4">
                                <div class="font-medium">3학년</div>
                                <div class="text-slate-400 text-xs">믿음반</div>
                            </td>
                            <td class="p-4">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="font-bold text-indigo-600 text-xs">LV.12</span>
                                    <span class="text-[10px] text-slate-400">1,250/2,000</span>
                                </div>
                                <div class="w-24 h-1.5 bg-slate-100 rounded-full overflow-hidden">
                                    <div class="bg-indigo-500 h-full" style="width: 65%"></div>
                                </div>
                            </td>
                            <td class="p-4">
                                <div class="text-amber-600 font-semibold"><i
                                        class="fas fa-coins mr-1 text-amber-400"></i> 5,400
                                </div>
                            </td>
                            <td class="p-4 text-slate-500 font-mono text-xs">
                                010-1234-5678
                            </td>
                            <td class="p-4 text-center">
                                <button class="text-slate-400 hover:text-indigo-600 p-1.5 rounded transition"><i
                                        class="fas fa-edit"></i></button>
                                <button class="text-slate-400 hover:text-red-500 p-1.5 rounded transition"><i
                                        class="fas fa-trash-alt"></i></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="page-notice-write" class="page-content hidden-page">
                <header class="flex justify-between items-center mb-6">
                    <div class="flex items-center">
                        <button onclick="showPage('notice')"
                                class="mr-3 p-2 rounded-full hover:bg-slate-200 text-slate-500 transition">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <h1 class="text-2xl font-bold text-slate-800">새 공지 작성</h1>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="showPage('notice')"
                                class="px-4 py-2 border border-slate-300 rounded-lg text-slate-600 hover:bg-slate-50 text-sm font-medium transition">
                            취소
                        </button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm font-medium shadow-sm transition flex items-center">
                            <i class="fas fa-paper-plane mr-2"></i> 등록
                        </button>
                    </div>
                </header>

                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm max-w-4xl mx-auto">
                    <form class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="md:col-span-1">
                                <label class="block text-sm font-bold text-slate-700 mb-2">분류</label>
                                <select class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-slate-700 bg-white">
                                    <option value="notice">📢 일반 공지</option>
                                    <option value="event">🎉 이벤트</option>
                                </select>
                            </div>
                            <div class="md:col-span-3">
                                <label class="block text-sm font-bold text-slate-700 mb-2">제목</label>
                                <input type="text" placeholder="제목 입력"
                                       class="w-full border border-slate-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-slate-800 placeholder-slate-400">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">내용</label>
                            <div class="border border-slate-300 rounded-lg overflow-hidden">
                                <div class="bg-slate-50 border-b border-slate-200 p-2 flex gap-1">
                                    <button type="button"
                                            class="p-1.5 rounded hover:bg-slate-200 text-slate-500 text-sm"><i
                                            class="fas fa-bold"></i></button>
                                    <button type="button"
                                            class="p-1.5 rounded hover:bg-slate-200 text-slate-500 text-sm"><i
                                            class="fas fa-list-ul"></i></button>
                                </div>
                                <textarea
                                        class="w-full h-64 p-4 outline-none resize-none text-slate-700 leading-relaxed text-sm"
                                        placeholder="내용을 입력하세요."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
			
			<div id="page-quest" class="page-content hidden-page">
    <header class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-2xl font-bold text-slate-800">퀘스트 승인 관리</h1>
            <p class="text-sm text-slate-500 mt-1">학생들이 제출한 퀘스트 인증샷을 확인하고 보상을 지급합니다.</p>
        </div>
        <div class="flex gap-2">
            <button class="bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-slate-50 transition shadow-sm">
                <i class="fas fa-history mr-2"></i> 처리 내역
            </button>
        </div>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
            <div>
                <p class="text-sm text-slate-400 font-bold mb-1">대기 중인 요청</p>
                <h3 class="text-2xl font-bold text-amber-500">12건</h3>
            </div>
            <div class="p-3 bg-amber-50 rounded-lg text-amber-500">
                <i class="fas fa-clock text-xl"></i>
            </div>
        </div>
        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
            <div>
                <p class="text-sm text-slate-400 font-bold mb-1">오늘 승인 완료</p>
                <h3 class="text-2xl font-bold text-emerald-600">28건</h3>
            </div>
            <div class="p-3 bg-emerald-50 rounded-lg text-emerald-600">
                <i class="fas fa-check-double text-xl"></i>
            </div>
        </div>
        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
            <div>
                <p class="text-sm text-slate-400 font-bold mb-1">오늘 반려됨</p>
                <h3 class="text-2xl font-bold text-red-500">3건</h3>
            </div>
            <div class="p-3 bg-red-50 rounded-lg text-red-500">
                <i class="fas fa-times-circle text-xl"></i>
            </div>
        </div>
    </div>

    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm mb-6 flex flex-wrap gap-4 justify-between items-center">
        <div class="flex gap-2">
            <select id="questStatusFilter" onchange="renderQuestTable()" class="border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none bg-white text-slate-600">
                <option value="all">전체 상태</option>
                <option value="pending" selected>대기 중 (Pending)</option>
                <option value="approved">승인됨</option>
                <option value="rejected">반려됨</option>
            </select>
            <select class="border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none bg-white text-slate-600">
                <option value="">모든 퀘스트</option>
                <option value="daily">일일 퀘스트</option>
                <option value="weekly">주간 퀘스트</option>
                <option value="special">특별 퀘스트</option>
            </select>
        </div>
        <div class="relative w-full md:w-64">
            <input type="text" placeholder="학생 이름 검색"
                   class="w-full pl-9 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none">
            <i class="fas fa-search absolute left-3 top-2.5 text-slate-400 text-xs"></i>
        </div>
    </div>

    <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
        <table class="w-full text-left">
            <thead class="bg-slate-50 text-slate-500 text-xs uppercase font-semibold">
            <tr>
                <th class="p-4 w-32">요청 시간</th>
                <th class="p-4">학생 정보</th>
                <th class="p-4">퀘스트 내용</th>
                <th class="p-4 text-center">인증</th>
                <th class="p-4">보상</th>
                <th class="p-4 text-center">상태</th>
                <th class="p-4 text-center">관리</th>
            </tr>
            </thead>
            <tbody id="questTableBody" class="divide-y divide-slate-100 text-sm text-slate-700">
                </tbody>
        </table>
        <div class="p-4 border-t border-slate-100 flex justify-center items-center space-x-1 text-sm">
            <button class="px-2 py-1 text-slate-400 hover:text-indigo-600 disabled:opacity-50"><i class="fas fa-chevron-left"></i></button>
            <button class="px-3 py-1 font-semibold text-indigo-600 bg-indigo-50 rounded">1</button>
            <button class="px-3 py-1 text-slate-500 hover:bg-slate-100 rounded">2</button>
            <button class="px-3 py-1 text-slate-500 hover:bg-slate-100 rounded">3</button>
            <button class="px-2 py-1 text-slate-400 hover:text-indigo-600"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>
</div>

<div id="questModal" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-slate-900 bg-opacity-40 transition-opacity backdrop-blur-sm" onclick="closeQuestModal()"></div>

    <div class="fixed inset-0 z-10 overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
            <div class="relative transform overflow-hidden rounded-xl bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl">
                
                <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4 border-b border-slate-100 flex justify-between items-start">
                    <div>
                        <h3 class="text-lg font-bold leading-6 text-slate-900" id="modal-title">퀘스트 인증 확인</h3>
                        <p class="text-sm text-slate-500 mt-1">제출된 인증 사진을 확인하고 승인 여부를 결정해주세요.</p>
                    </div>
                    <button onclick="closeQuestModal()" class="text-slate-400 hover:text-slate-600 transition">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>

                <div class="bg-slate-50 px-4 py-6 sm:p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex flex-col gap-2">
                        <div class="aspect-w-4 aspect-h-3 w-full overflow-hidden rounded-lg bg-slate-200 border border-slate-300 relative group">
                            <img id="modalQuestImage" src="" alt="Proof" class="object-cover w-full h-64">
                            <a id="modalImageLink" href="#" target="_blank" class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition flex items-center justify-center opacity-0 group-hover:opacity-100">
                                <span class="bg-white/90 text-slate-800 px-3 py-1.5 rounded-full text-xs font-bold shadow-sm">
                                    <i class="fas fa-expand mr-1"></i> 원본 보기
                                </span>
                            </a>
                        </div>
                        <div class="text-xs text-slate-400 text-center mt-1">
                            <i class="fas fa-camera mr-1"></i> 촬영일시: 2026.02.24 14:30
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="flex items-center gap-3 pb-4 border-b border-slate-200">
                            <img id="modalStudentAvatar" src="" class="w-10 h-10 rounded-full bg-white border border-slate-200">
                            <div>
                                <div id="modalStudentName" class="font-bold text-slate-800"></div>
                                <div id="modalStudentClass" class="text-xs text-slate-500"></div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">퀘스트명</label>
                            <div id="modalQuestTitle" class="text-sm font-semibold text-slate-800"></div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">학생의 한마디</label>
                            <div id="modalStudentComment" class="bg-white border border-slate-200 rounded-lg p-3 text-sm text-slate-600 italic">
                                "선생님 저 이번엔 진짜 열심히 했어요!"
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-1">보상 정보</label>
                            <div class="flex gap-2">
                                <span id="modalRewardExp" class="px-2.5 py-1 rounded bg-indigo-50 text-indigo-700 text-xs font-bold border border-indigo-100"></span>
                                <span id="modalRewardGold" class="px-2.5 py-1 rounded bg-amber-50 text-amber-700 text-xs font-bold border border-amber-100"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="rejectReasonSection" class="hidden px-4 py-3 bg-red-50 border-t border-red-100 transition-all">
                    <label class="block text-xs font-bold text-red-600 mb-1">반려 사유 입력</label>
                    <div class="flex gap-2">
                        <input type="text" id="rejectReasonInput" class="flex-1 text-sm border-red-200 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-red-500" placeholder="예: 사진이 흐려서 확인할 수 없습니다.">
                        <button onclick="confirmReject()" class="bg-red-600 text-white text-xs px-3 py-1 rounded hover:bg-red-700 font-bold">확인</button>
                    </div>
                </div>

                <div class="bg-white px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 border-t border-slate-100">
                    <button type="button" onclick="confirmApprove()" class="inline-flex w-full justify-center rounded-lg bg-indigo-600 px-4 py-2.5 text-sm font-bold text-white shadow-sm hover:bg-indigo-700 sm:ml-3 sm:w-auto transition flex items-center">
                        <i class="fas fa-check mr-2"></i> 승인하기
                    </button>
                    <button type="button" onclick="toggleRejectInput()" class="mt-3 inline-flex w-full justify-center rounded-lg bg-white px-4 py-2.5 text-sm font-bold text-slate-600 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 sm:mt-0 sm:w-auto transition">
                        반려
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

        </div>
    </main>
</div>

<script>
    function showPage(pageId, btnElement) {
        const loadingContainer = document.getElementById('loading-container');
        const loadingBar = document.getElementById('loading-bar');

        // 1. 로딩바 시작
        loadingContainer.classList.remove('hidden');

        // 약간의 지연을 주어 transition 효과 적용 (0% -> 70%)
        requestAnimationFrame(() => {
            loadingBar.style.width = '70%';
        });

        // 2. 가상의 로딩 시간 (300ms) 후 페이지 전환
        setTimeout(() => {
            // 로딩바 100% 도달
            loadingBar.style.width = '100%';

            // 3. 실제 페이지 전환 로직
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden-page');
            });
            document.getElementById('page-' + pageId).classList.remove('hidden-page');

            // 네비게이션 버튼 스타일 업데이트
            // (사이드바 메뉴 클릭 시에만 작동하도록 btnElement 체크)
            if (btnElement) {
                document.querySelectorAll('.nav-item').forEach(nav => {
                    // 기본 스타일로 초기화
                    nav.className = 'nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors';
                });
                // 활성 스타일 적용
                btnElement.className = 'nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors bg-slate-100 text-indigo-700';
            }

            // 4. 로딩바 숨기기 (애니메이션이 끝난 후)
            setTimeout(() => {
                loadingContainer.classList.add('hidden');
                loadingBar.style.width = '0%'; // 다음을 위해 초기화
            }, 200); // 100% 상태를 잠시 보여주고 사라짐

        }, 300); // 0.3초 딜레이 (사용자가 로딩감을 느낄 수 있는 최소 시간)
    }

    Apex.chart = {fontFamily: "Pretendard, sans-serif"};

    var chart1 = new ApexCharts(document.querySelector("#attendanceChart"), {
        series: [{name: '출석', data: [18, 20, 19, 22, 24, 24, 23]}],
        chart: {height: 320, type: 'area', toolbar: {show: false}, zoom: {enabled: false}},
        colors: ['#6366f1'],
        dataLabels: {enabled: false},
        stroke: {curve: 'smooth', width: 2},
        fill: {type: 'gradient', gradient: {shadeIntensity: 1, opacityFrom: 0.4, opacityTo: 0.05, stops: [0, 100]}},
        xaxis: {
            categories: ['12/15', '12/22', '12/29', '01/05', '01/12', '01/19', '01/26'],
            axisBorder: {show: false},
            axisTicks: {show: false},
            labels: {style: {colors: '#94a3b8'}}
        },
        yaxis: {show: false},
        grid: {borderColor: '#f1f5f9', strokeDashArray: 4}
    });
    chart1.render();

    var chart2 = new ApexCharts(document.querySelector("#classChart"), {
        series: [12, 9, 5],
        labels: ['믿음반', '소망반', '사랑반'],
        chart: {type: 'donut', height: 260},
        colors: ['#6366f1', '#2dd4bf', '#fbbf24'],
        plotOptions: {
            pie: {
                donut: {
                    size: '75%',
                    labels: {show: true, total: {show: true, label: '총원', color: '#64748b'}}
                }
            }
        },
        legend: {show: false},
        dataLabels: {enabled: false},
        stroke: {show: false}
    });
    chart2.render();

    var chart3 = new ApexCharts(document.querySelector("#questChart"), {
        series: [{name: '완료', data: [5, 12, 18, 10, 8, 24, 30]}],
        chart: {type: 'bar', height: 250, toolbar: {show: false}},
        colors: ['#cbd5e1'],
        plotOptions: {bar: {borderRadius: 4, columnWidth: '40%', distributed: true}},
        colors: ['#cbd5e1', '#cbd5e1', '#cbd5e1', '#cbd5e1', '#cbd5e1', '#6366f1', '#6366f1'],
        legend: {show: false},
        dataLabels: {enabled: false},
        xaxis: {categories: ['월', '화', '수', '목', '금', '토', '일'], axisBorder: {show: false}, axisTicks: {show: false}},
        grid: {show: false}
    });
    chart3.render();

    flatpickr("#dateRangePicker", {
        mode: "range",
        dateFormat: "Y.m.d",
        defaultDate: [new Date().fp_incr(-30), new Date()],
        locale: "ko",
        theme: "airbnb"
    });
    // ==========================================
    // [추가] 최근 조정 내역 페이징 처리 로직
    // ==========================================

    // 1. 더미 데이터 생성 (테스트용 15개)
    const adjustmentData = [
        {time: '10:42 AM', name: '김철수', content: '특별 심부름 보상', change: '+50 EXP', type: 'exp-plus', admin: 'T.Lee'},
        {time: '09:15 AM', name: '이영희', content: '상점 아이템 구매', change: '-200 Gold', type: 'gold-minus', admin: 'System'},
        {time: '08:30 AM', name: '박민수', content: '아침 큐티 참석', change: '+10 EXP', type: 'exp-plus', admin: 'T.Kim'},
        {time: '어제', name: '최유리', content: '친구 전도', change: '+100 EXP', type: 'exp-plus', admin: 'T.Lee'},
        {time: '어제', name: '강호동', content: '지각 페널티', change: '-10 EXP', type: 'exp-minus', admin: 'T.Park'},
        {time: '어제', name: '유재석', content: '반장 선출 보너스', change: '+500 Gold', type: 'gold-plus', admin: 'Principal'},
        {time: '2일 전', name: '김철수', content: '준비물 미지참', change: '-50 Gold', type: 'gold-minus', admin: 'T.Lee'},
        {time: '2일 전', name: '이영희', content: '성경 암송 완료', change: '+30 EXP', type: 'exp-plus', admin: 'T.Kim'},
        {time: '3일 전', name: '박민수', content: '청소 당번 우수', change: '+100 Gold', type: 'gold-plus', admin: 'T.Park'},
        {time: '3일 전', name: '홍길동', content: '예배 태도 불량', change: '-20 EXP', type: 'exp-minus', admin: 'T.Choi'},
        {time: '4일 전', name: '김영희', content: '주보 접기 봉사', change: '+50 EXP', type: 'exp-plus', admin: 'T.Lee'},
        {time: '4일 전', name: '이철수', content: '간식 구매', change: '-500 Gold', type: 'gold-minus', admin: 'System'},
        {time: '5일 전', name: '박지성', content: '축구 대회 우승', change: '+300 EXP', type: 'exp-plus', admin: 'Coach'},
        {time: '5일 전', name: '손흥민', content: '축구 대회 우승', change: '+300 EXP', type: 'exp-plus', admin: 'Coach'},
        {time: '6일 전', name: '김연아', content: '특별 공연', change: '+1000 Gold', type: 'gold-plus', admin: 'Principal'},
    ];

    let currentAdjPage = 1;
    const itemsPerAdjPage = 5; // 페이지당 5개씩 출력

    function renderAdjustmentTable(page) {
        const tableBody = document.getElementById('adjustmentTableBody');
        const paginationContainer = document.getElementById('adjustmentPagination');

        // 1. 현재 페이지 데이터 슬라이싱
        const start = (page - 1) * itemsPerAdjPage;
        const end = start + itemsPerAdjPage;
        const paginatedItems = adjustmentData.slice(start, end);
        const totalPages = Math.ceil(adjustmentData.length / itemsPerAdjPage);

        // 2. 테이블 비우기 및 다시 그리기
        tableBody.innerHTML = "";

        paginatedItems.forEach(item => {
            // 변동값 색상 결정
            let colorClass = "text-slate-600";
            if (item.type.includes('plus')) colorClass = item.type.includes('exp') ? "text-green-600" : "text-amber-600";
            if (item.type.includes('minus')) colorClass = "text-red-500";

            const row = `
                <tr class="hover:bg-slate-50 transition">
                    <td class="px-4 py-3 text-slate-500">${item.time}</td>
                    <td class="px-4 py-3 font-medium text-slate-800">${item.name}</td>
                    <td class="px-4 py-3 text-slate-600">${item.content}</td>
                    <td class="px-4 py-3 font-medium ${colorClass}">${item.change}</td>
                    <td class="px-4 py-3 text-slate-400">${item.admin}</td>
                </tr>
            `;
            tableBody.insertAdjacentHTML('beforeend', row);
        });

        // 3. 페이지네이션 버튼 그리기
        let paginationHTML = `
            <button onclick="changeAdjPage(${page - 1})" ${page === 1 ? 'disabled' : ''} class="px-2 py-1 text-slate-400 hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-slate-400 transition">
                <i class="fas fa-chevron-left"></i>
            </button>
        `;

        for (let i = 1; i <= totalPages; i++) {
            if (i === page) {
                // 현재 페이지 (활성화)
                paginationHTML += `<button class="px-3 py-1 font-semibold text-indigo-600 bg-indigo-50 rounded transition">${i}</button>`;
            } else {
                // 다른 페이지
                paginationHTML += `<button onclick="changeAdjPage(${i})" class="px-3 py-1 text-slate-500 hover:bg-slate-100 rounded transition">${i}</button>`;
            }
        }

        paginationHTML += `
            <button onclick="changeAdjPage(${page + 1})" ${page === totalPages ? 'disabled' : ''} class="px-2 py-1 text-slate-400 hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-slate-400 transition">
                <i class="fas fa-chevron-right"></i>
            </button>
        `;

        paginationContainer.innerHTML = paginationHTML;
    }

    // 페이지 변경 함수
    function changeAdjPage(newPage) {
        const totalPages = Math.ceil(adjustmentData.length / itemsPerAdjPage);

        // 유효성 검사 (범위를 벗어나면 실행 안 함)
        if (newPage < 1 || newPage > totalPages) return;

        // 현재 페이지와 같으면 실행 안 함 (선택사항)
        if (newPage === currentAdjPage) return;

        // 1. 로딩바 요소 가져오기
        const loadingContainer = document.getElementById('loading-container');
        const loadingBar = document.getElementById('loading-bar');

        // 2. 로딩 시작 (시각적 효과)
        loadingContainer.classList.remove('hidden');

        // 약간의 지연을 주어 애니메이션 시작
        requestAnimationFrame(() => {
            loadingBar.style.width = '60%'; // 페이징은 가벼운 작업이라 느낌을 주기 위해 60%까지 빠르게 이동
        });

        // 3. 가상의 데이터 로딩 시간 (300ms)
        setTimeout(() => {
            // 데이터 변경 적용
            currentAdjPage = newPage;
            renderAdjustmentTable(currentAdjPage);

            // 로딩 완료 처리
            loadingBar.style.width = '100%';

            // 로딩바 숨기기
            setTimeout(() => {
                loadingContainer.classList.add('hidden');
                loadingBar.style.width = '0%';
            }, 200);

        }, 300); // 0.3초 딜레이
    }

    // 초기 로드
    document.addEventListener('DOMContentLoaded', function () {
        renderAdjustmentTable(1);
    });
	// ==========================================
    // [추가] 퀘스트 승인 관리 로직
    // ==========================================

    // 1. 더미 데이터 (퀘스트 요청)
    const questRequests = [
        {
            id: 1,
            time: '방금 전',
            fullTime: '2026-02-24 14:30',
            studentName: '김철수',
            studentClass: '믿음반 (3학년)',
            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Felix',
            questTitle: '📖 주일 설교 요약하기',
            questType: 'weekly',
            proofImage: 'https://images.unsplash.com/photo-1455390582262-044cdead277a?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
            comment: '목사님 말씀 너무 좋았습니다! 요약해서 올립니다.',
            rewardExp: 100,
            rewardGold: 50,
            status: 'pending'
        },
        {
            id: 2,
            time: '10분 전',
            fullTime: '2026-02-24 14:20',
            studentName: '이영희',
            studentClass: '소망반 (2학년)',
            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka',
            questTitle: '🧹 내 방 청소 인증',
            questType: 'daily',
            proofImage: 'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
            comment: '깨끗하게 청소했어요~',
            rewardExp: 30,
            rewardGold: 10,
            status: 'pending'
        },
        {
            id: 3,
            time: '30분 전',
            fullTime: '2026-02-24 14:00',
            studentName: '박민수',
            studentClass: '사랑반 (1학년)',
            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bob',
            questTitle: '🙏 아침 기도하기',
            questType: 'daily',
            proofImage: 'https://images.unsplash.com/photo-1507692049790-de58293a469d?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
            comment: '오늘도 감사한 하루!',
            rewardExp: 20,
            rewardGold: 5,
            status: 'approved'
        },
        {
            id: 4,
            time: '1시간 전',
            fullTime: '2026-02-24 13:30',
            studentName: '최유리',
            studentClass: '믿음반 (3학년)',
            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Yuri',
            questTitle: '🎨 성경 그림 그리기',
            questType: 'special',
            proofImage: 'https://images.unsplash.com/photo-1513364776144-60967b0f800f?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
            comment: '노아의 방주를 그렸어요.',
            rewardExp: 150,
            rewardGold: 100,
            status: 'rejected'
        }
    ];

    // 현재 선택된 퀘스트 ID 저장용
    let currentQuestId = null;

    // 테이블 렌더링 함수
    function renderQuestTable() {
        const filterStatus = document.getElementById('questStatusFilter').value;
        const tbody = document.getElementById('questTableBody');
        tbody.innerHTML = '';

        const filteredData = questRequests.filter(item => {
            if (filterStatus === 'all') return true;
            return item.status === filterStatus;
        });

        if (filteredData.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" class="p-8 text-center text-slate-400">데이터가 없습니다.</td></tr>';
            return;
        }

        filteredData.forEach(item => {
            // 상태 뱃지 스타일
            let statusBadge = '';
            if (item.status === 'pending') statusBadge = '<span class="bg-amber-50 text-amber-600 border border-amber-100 px-2 py-1 rounded-md text-xs font-bold"><i class="fas fa-spinner fa-spin mr-1"></i> 대기 중</span>';
            else if (item.status === 'approved') statusBadge = '<span class="bg-indigo-50 text-indigo-600 border border-indigo-100 px-2 py-1 rounded-md text-xs font-bold">승인됨</span>';
            else if (item.status === 'rejected') statusBadge = '<span class="bg-red-50 text-red-600 border border-red-100 px-2 py-1 rounded-md text-xs font-bold">반려됨</span>';

            const row = `
                <tr class="hover:bg-slate-50 transition border-b border-slate-50 last:border-0 cursor-pointer" onclick="openQuestModal(${item.id})">
                    <td class="p-4 text-slate-500 font-mono text-xs">${item.time}</td>
                    <td class="p-4">
                        <div class="flex items-center gap-3">
                            <img src="${item.avatar}" class="w-8 h-8 rounded-full bg-slate-100 border border-slate-200">
                            <div>
                                <div class="font-bold text-slate-800 text-xs">${item.studentName}</div>
                                <div class="text-[10px] text-slate-400">${item.studentClass}</div>
                            </div>
                        </div>
                    </td>
                    <td class="p-4 font-medium text-slate-700">
                        <span class="text-[10px] text-slate-400 border border-slate-200 rounded px-1 mr-1 uppercase">${item.questType}</span>
                        ${item.questTitle}
                    </td>
                    <td class="p-4 text-center">
                        <div class="w-10 h-10 rounded bg-slate-100 border border-slate-200 mx-auto overflow-hidden relative group">
                            <img src="${item.proofImage}" class="w-full h-full object-cover">
                            <div class="absolute inset-0 bg-black/20 hidden group-hover:flex items-center justify-center text-white text-xs">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                    </td>
                    <td class="p-4">
                        <div class="flex flex-col gap-1">
                            <span class="text-xs font-bold text-indigo-600">+${item.rewardExp} EXP</span>
                            <span class="text-[10px] font-bold text-amber-500">+${item.rewardGold} G</span>
                        </div>
                    </td>
                    <td class="p-4 text-center">${statusBadge}</td>
                    <td class="p-4 text-center" onclick="event.stopPropagation()">
                        ${item.status === 'pending' ? `
                            <button onclick="openQuestModal(${item.id})" class="text-xs bg-indigo-600 text-white px-3 py-1.5 rounded hover:bg-indigo-700 transition font-bold shadow-sm">
                                심사
                            </button>
                        ` : `
                            <button class="text-slate-400 hover:text-slate-600"><i class="fas fa-ellipsis-h"></i></button>
                        `}
                    </td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', row);
        });
    }

    // 모달 열기
    function openQuestModal(id) {
        const item = questRequests.find(q => q.id === id);
        if (!item) return;

        currentQuestId = id;

        // 데이터 바인딩
        document.getElementById('modalStudentName').textContent = item.studentName;
        document.getElementById('modalStudentClass').textContent = item.studentClass;
        document.getElementById('modalStudentAvatar').src = item.avatar;
        
        document.getElementById('modalQuestTitle').textContent = item.questTitle;
        document.getElementById('modalStudentComment').textContent = `"${item.comment}"`;
        
        document.getElementById('modalQuestImage').src = item.proofImage;
        document.getElementById('modalImageLink').href = item.proofImage;
        
        document.getElementById('modalRewardExp').textContent = `+${item.rewardExp} EXP`;
        document.getElementById('modalRewardGold').textContent = `+${item.rewardGold} G`;

        // 반려 입력창 초기화
        document.getElementById('rejectReasonSection').classList.add('hidden');
        document.getElementById('rejectReasonInput').value = '';

        // 모달 표시
        document.getElementById('questModal').classList.remove('hidden');
    }

    // 모달 닫기
    function closeQuestModal() {
        document.getElementById('questModal').classList.add('hidden');
        currentQuestId = null;
    }

    // 반려 입력창 토글
    function toggleRejectInput() {
        const section = document.getElementById('rejectReasonSection');
        section.classList.toggle('hidden');
        if (!section.classList.contains('hidden')) {
            document.getElementById('rejectReasonInput').focus();
        }
    }

    // 승인 처리 (예시)
    function confirmApprove() {
        if(!currentQuestId) return;
        alert("성공적으로 승인되었습니다! 보상이 지급됩니다.");
        
        // 데이터 상태 업데이트 (실제로는 서버 통신)
        const item = questRequests.find(q => q.id === currentQuestId);
        if(item) item.status = 'approved';
        
        renderQuestTable();
        closeQuestModal();
    }

    // 반려 처리 (예시)
    function confirmReject() {
        const reason = document.getElementById('rejectReasonInput').value;
        if (!reason) {
            alert("반려 사유를 입력해주세요.");
            return;
        }
        alert(`반려되었습니다. (사유: ${reason})`);
        
        // 데이터 상태 업데이트
        const item = questRequests.find(q => q.id === currentQuestId);
        if(item) item.status = 'rejected';

        renderQuestTable();
        closeQuestModal();
    }

    // 페이지 로드 시 퀘스트 테이블 초기화
    document.addEventListener('DOMContentLoaded', function () {
        renderQuestTable();
    });
</script>
</body>
</html>
